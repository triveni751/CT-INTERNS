import requests
from bs4 import BeautifulSoup
import re

class WebAppScanner:
    def __init__(self, target_url):
        self.target_url = target_url
        self.vulnerabilities = {
            'SQL Injection': self.check_sql_injection,
            'XSS': self.check_xss
        }

    def scan(self):
        print(f"Scanning {self.target_url} for vulnerabilities...\n")
        for vulnerability, check_method in self.vulnerabilities.items():
            print(f"Checking for {vulnerability}...")
            if check_method():
                print(f"[+] Vulnerability found: {vulnerability}")
            else:
                print(f"[-] No {vulnerability} vulnerability found.")

    def check_sql_injection(self):
        # Test for SQL Injection
        payloads = ["' OR '1'='1", "' OR '1'='1' --", "' OR '1'='1' /*"]
        for payload in payloads:
            url = f"{self.target_url}?id={payload}"
            response = requests.get(url)
            if "error" in response.text.lower() or "mysql" in response.text.lower():
                return True
        return False

    def check_xss(self):
        # Test for XSS
        payloads = ["<script>alert('XSS')</script>", "'><script>alert('XSS')</script>"]
        for payload in payloads:
            url = f"{self.target_url}?input={payload}"
            response = requests.get(url)
            if payload in response.text:
                return True
        return False

if __name__ == "__main__":
    target = input("Enter the target URL: ")
    scanner = WebAppScanner(target)
    scanner.scan()
